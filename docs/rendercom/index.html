
<!DOCTYPE HTML>
<html lang="ja" >
    <head>
        <meta charset="UTF-8">
        <title>Render で oTree を動かす · oTree 5 勉強会</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="HonKit 3.7.4">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-page-toc/page-toc.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-accordion/accordion.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/@honkit/honkit-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../styles/website.css">
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    
    <link rel="prev" href="../heroku/" />
    

    </head>
    <body>
        
<div class="book honkit-cloak">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="検索ワードを入力" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    【oTree 5 勉強会】
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../day1.html">
            
                <a href="../day1.html">
            
                    
                    Ubuntuで oTree 本番環境を構築する
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../day2.html">
            
                <a href="../day2.html">
            
                    
                    GitとGitHubの使い方 ・ Herokuの使い方
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../day3.html">
            
                <a href="../day3.html">
            
                    
                    VS Code の導入 ・ oTree プログラミングの概要
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../day4.html">
            
                <a href="../day4.html">
            
                    
                    oTree プログラミングの進め方
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../day5.html">
            
                <a href="../day5.html">
            
                    
                    テンプレートにおけるプログラミング
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../day6.html">
            
                <a href="../day6.html">
            
                    
                    oTree の組み込み関数の使い方
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../day7.html">
            
                <a href="../day7.html">
            
                    
                    （Qualtricsのような）質問紙調査を作る方法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../day8.html">
            
                <a href="../day8.html">
            
                    
                    ExtraModel ・ JavaScript ・ Live page
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../exercise.html">
            
                <a href="../exercise.html">
            
                    
                    演習 （少し特殊な最後通牒ゲームを作る）
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="2.1" >
            
                <span>
            
                    
                    【資料: 開発編】
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../otree_ref/cmd.html">
            
                <a href="../otree_ref/cmd.html">
            
                    
                    シェルで使用するoTreeサブコマンド
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../otree_ref/settings.html">
            
                <a href="../otree_ref/settings.html">
            
                    
                    settings.py の書き方
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="../otree_ref/init.html">
            
                <a href="../otree_ref/init.html">
            
                    
                    __init__.py の書き方
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="../otree_ref/templatefile.html">
            
                <a href="../otree_ref/templatefile.html">
            
                    
                    テンプレートファイルの書き方
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="3.1" >
            
                <span>
            
                    
                    【資料: デプロイ編】
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="../server_setup/">
            
                <a href="../server_setup/">
            
                    
                    Ubuntu で oTree を動かす
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="../heroku/">
            
                <a href="../heroku/">
            
                    
                    Heroku で oTree を動かす
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="3.4" data-path="./">
            
                <a href="./">
            
                    
                    Render で oTree を動かす
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="4.1" >
            
                <span>
            
                    
                    【資料: その他】
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="../ubuntu/">
            
                <a href="../ubuntu/">
            
                    
                    Ubuntuの仮想環境の構築
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.2.1" data-path="../ubuntu/wsl2.html">
            
                <a href="../ubuntu/wsl2.html">
            
                    
                    WSL2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.2" data-path="../ubuntu/vagrant.html">
            
                <a href="../ubuntu/vagrant.html">
            
                    
                    VirtualBox + Vagrant
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="../references/">
            
                <a href="../references/">
            
                    
                    参考文献
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://github.com/honkit/honkit" target="blank" class="gitbook-link">
            HonKitで公開 
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Render で oTree を動かす</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="render-で-otree-を動かす">Render で oTree を動かす</h1>
<h2 id="heroku-の代替">Heroku の代替</h2>
<ul>
<li>そもそも，Herokuとは，ハードウェア，OSの管理を人任せにして，自分はアプリケーション（oTree）だけ管理すればよい，という仕組み．</li>
<li>Herokuのようなサービスを一般にPaaS (Platform as a Service) と呼ぶ．</li>
<li>PaaS は Salesforce による Heroku だけではなく，他の企業もサービスを提供していて，どれを選んでも oTree は動かせる（はず）．<ul>
<li><a href="https://cloud.google.com/appengine/" target="_blank">Google App Engine</a></li>
<li><a href="https://aws.amazon.com/jp/elasticbeanstalk/" target="_blank">AWS Elastic Beanstalk</a></li>
</ul>
</li>
</ul>
<h2 id="render">Render</h2>
<p><img src="fig/render01.png" alt="render01"></p>
<ul>
<li><p>PaaS の新興勢力 <a href="https://render.com/" target="_blank">Render</a></p>
</li>
<li><p>Heroku に対してバチバチに対抗意識を燃やしている．</p>
<ul>
<li><a href="https://render.com/render-vs-heroku-comparison" target="_blank">https://render.com/render-vs-heroku-comparison</a><blockquote>
<p>We’ve built Render to help developers and businesses avoid the cost and inflexibility traps of legacy Platform-as-a-Service solutions like Heroku. Our customers often tell us Render is what Heroku could have been. This page explains why so many former Heroku customers consider Render to be the best Heroku alternative.</p>
</blockquote>
</li>
</ul>
</li>
<li><p>Heroku の Dyno は Hobby プラン（$7/月，RAM 512MB）の上が Standard-1X プラン（$25/月，RAM 512MB）， Standard-2X プラン（$50/月，RAM 1GB），であるのに対し， Render は Starter プラン（$7/月，RAM 512MB）の上が Starter Plus プラン（$15/月，RAM 1GB），Standard プラン（$25/月，RAM 2GB）．大きなRAMが必要な場合は Render の方が安いかもしれない．</p>
</li>
<li><p>Heroku の Postgres は無料プラン（ストレージ 1GB，1万件）の上が， Hobby Basic プラン（$9/月，ストレージ 10GB，1000万件）， Standard 0 プラン（$50/月，ストレージ 64GB），であるのに対し， Render は無料プラン（ストレージ 1GB，件数無制限，ただし90日間）の上が， Starter プラン（$7/月，ストレージ 1GB）， Standard プラン（$20/月，RAM 16GB）． Render はデータベースの件数制限が無いため， Starter プランで十分かもしれない．そうすると結局 Heroku よりも安上がりで済むかもしれない．</p>
</li>
<li><p>Render はリージョン（物理的なサーバーの所在地）としてシンガポールも選べる． Heroku はアメリカかヨーロッパしか選べなかった．</p>
</li>
</ul>
<h2 id="render-でデプロイする">Render でデプロイする</h2>
<h3 id="1-otree-プロジェクトを-github-にアップロード（push）する">1. oTree プロジェクトを GitHub にアップロード（Push）する</h3>
<ul>
<li>リポジトリのルートに <code>settings.py</code>， <code>requirements.txt</code>，各アプリのディレクトリなどを配置する．</li>
<li>Heroku で必要だった <code>Procfile</code> （起動時のコマンドを指定）， <code>runtime.txt</code> （Pythonのバージョンを指定）の2ファイルは不要．</li>
</ul>
<h3 id="2-render-で-postgresql-のインスタンスを作成しておく">2. Render で PostgreSQL のインスタンスを作成しておく</h3>
<ul>
<li><p>動作確認で PostgreSQL が不要であればスキップしても良い．</p>
</li>
<li><p>「New +」を押して，「PostgreSQL」を選択．</p>
</li>
</ul>
<p><img src="fig/render02.png" alt="render02"></p>
<ul>
<li>設定<ul>
<li>Name: インスタンスの名前（何でも良い）</li>
<li>Database: PostgreSQL上でのデータベース名（空欄で良い）</li>
<li>User: PostgreSQL上でのユーザー名（空欄で良い）</li>
<li>Region: Singapore（日本で実施する場合）</li>
<li>PostgreSQL Version: 通常は14</li>
<li>Datadog API Key: 必要に応じて</li>
</ul>
</li>
</ul>
<p><img src="fig/render03.png" alt="render03"></p>
<ul>
<li>プラン選択 → 「Create Database」を押す．<ul>
<li>とりあえず Free を選んでおく．</li>
</ul>
</li>
</ul>
<p><img src="fig/render04.png" alt="render04"></p>
<p><img src="fig/render05.png" alt="render05"></p>
<ul>
<li>インスタンス作成後，「Info」ページ「Connections」の「Internal Database URL」をコピーして控えておく．</li>
</ul>
<p><img src="fig/render06.png" alt="render06"></p>
<h3 id="3-デプロイする">3. デプロイする</h3>
<ul>
<li>「New +」を押して，「Web Service」を選択．</li>
</ul>
<p><img src="fig/render07.png" alt="render07"></p>
<ul>
<li>（初回のみ） GitHub のアカウントと接続する．</li>
</ul>
<p><img src="fig/render08.png" alt="render08"></p>
<p><img src="fig/render09.png" alt="render09"></p>
<p><img src="fig/render10.png" alt="render10"></p>
<p><img src="fig/render11.png" alt="render11"></p>
<p><img src="fig/render12.png" alt="render12"></p>
<ul>
<li>デプロイしたいリポジトリを選択する．</li>
</ul>
<p><img src="fig/render13.png" alt="render13"></p>
<ul>
<li>設定<ul>
<li>Name: インスタンス名（この文字列がURLの一部になるので，参加者に見せてはいけない文字列にはしない．）</li>
<li>Environment: Python 3</li>
<li>Region: Singapore（日本で実施する場合）</li>
<li>Branch: GitHubリポジトリのブランチ名</li>
<li>Build Command: <code>pip install -r requirements.txt</code></li>
<li>Start Command: <code>otree prodserver</code></li>
</ul>
</li>
</ul>
<p><img src="fig/render14.png" alt="render14"></p>
<ul>
<li>プランの選択<ul>
<li>とりあえず Free を選んでおく．</li>
<li>まだ「Create Web Service」は押さない．</li>
</ul>
</li>
</ul>
<p><img src="fig/render15.png" alt="render15"></p>
<ul>
<li>「Advanced」を押して，環境変数を設定する．<ul>
<li><code>PYTHON_VERSION</code>: 使うPythonのバージョンを指定する．</li>
<li><code>OTREE_ADMIN_PASSWORD</code></li>
<li><code>OTREE_AUTH_LEVEL</code></li>
<li><code>OTREE_PRODUCTION</code></li>
<li><code>DATABASE_URL</code>: PostgreSQL インスタンスの「Internal Database URL」（<code>postgres://</code> から始まる文字列）．指定しなければデータベースとしてSQLiteが使われる．</li>
</ul>
</li>
</ul>
<p><img src="fig/render16.png" alt="render16"></p>
<ul>
<li>「Create Web Service」を押すとデプロイが開始する．</li>
</ul>
<p><img src="fig/render17.png" alt="render17"></p>
<ul>
<li>ターミナル画面で「Starting service with &apos;otree prodserver&apos;」と表示されたらデプロイ完了．</li>
</ul>
<p><img src="fig/render19.png" alt="render19"></p>
<ul>
<li>インスタンス名の下に表示されているURLにアクセスするとoTreeのページへ行けるはず．</li>
</ul>
<p><img src="fig/render20.png" alt="render20"></p>
<h3 id="4-設定変更の反映">4. 設定変更の反映</h3>
<ul>
<li>デプロイ後に環境変数を編集した場合，もう一度デプロイし直さないと反映されない．</li>
<li>無料プランの場合，一ヶ月にできるデプロイ作業は400回までなので，要注意．</li>
</ul>
<h3 id="5-データベースのリセット">5. データベースのリセット</h3>
<ul>
<li>無料プランではシェルが使えないため， <code>otree resetdb</code> が使えない．したがって PostgreSQL を作り直す．</li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../heroku/" class="navigation navigation-prev navigation-unique" aria-label="Previous page: Heroku で oTree を動かす">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Render で oTree を動かす","level":"3.4","depth":1,"next":{"title":"【資料: その他】","level":"4.1","depth":1,"ref":"","articles":[]},"previous":{"title":"Heroku で oTree を動かす","level":"3.3","depth":1,"path":"heroku/README.md","ref":"heroku/README.md","articles":[]},"dir":"ltr"},"config":{"plugins":["page-toc","sitemap","@honkit/honkit-plugin-ga","accordion"],"root":"./","styles":{"website":"styles/website.css"},"pluginsConfig":{"accordion":{},"search":{},"page-toc":{"selector":".markdown-section h2, .markdown-section h3, .markdown-section h4","position":"before-first","showByDefault":true},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"sitemap":{"url":"https://yshimod.github.io","pathSuffix":"/otree5-seminar/"},"@honkit/honkit-plugin-ga":{},"ga":{"trackingID":"G-6WR8KXSQYF"},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","author":"","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56},"embedFonts":false},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"oTree 5 勉強会","language":"ja","gitbook":"*","description":""},"file":{"path":"rendercom/README.md","mtime":"2022-09-12T13:09:22.313Z","type":"markdown"},"gitbook":{"version":"3.7.4","time":"2022-09-12T13:10:27.393Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <noscript>
        <style>
            .honkit-cloak {
                display: block !important;
            }
        </style>
    </noscript>
    <script>
        // Restore sidebar state as critical path for prevent layout shift
        function __init__getSidebarState(defaultValue){
            var baseKey = "";
            var key = baseKey + ":sidebar";
            try {
                var value = localStorage[key];
                if (value === undefined) {
                    return defaultValue;
                }
                var parsed = JSON.parse(value);
                return parsed == null ? defaultValue : parsed;
            } catch (e) {
                return defaultValue;
            }
        }
        function __init__restoreLastSidebarState() {
            var isMobile = window.matchMedia("(max-width: 600px)").matches;
            if (isMobile) {
                // Init last state if not mobile
                return;
            }
            var sidebarState = __init__getSidebarState(true);
            var book = document.querySelector(".book");
            // Show sidebar if it enabled
            if (sidebarState && book) {
                book.classList.add("without-animation", "with-summary");
            }
        }

        try {
            __init__restoreLastSidebarState();
        } finally {
            var book = document.querySelector(".book");
            book.classList.remove("honkit-cloak");
        }
    </script>
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-page-toc/anchor-3.1.1.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-page-toc/page-toc.js"></script>
        
    
        
        <script src="../gitbook/@honkit/honkit-plugin-ga/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-accordion/accordionSelector.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

